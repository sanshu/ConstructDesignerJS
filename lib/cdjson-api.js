var CDJsonAPI;CDJsonAPI=(()=>{"use strict";var e={175:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});const l=jQuery;var n=r.n(l);const s=function(e,t){return console.log(`Loading ${e}: ${t}`),n().ajax({type:"GET",cache:!1,url:t,async:!1})},a=async function(e,t){let r=e.split("------------------------------------------------------------------------------------------------------------------------");o(r[5],t),i(r[4],t),c(r[3],t),u(r[1],t),p(r[2],t),f(r[0],t)},o=function(e,t){const r=(e=e.replace("DISOPRED2 output:","")).trim().split("\n");let l={color:"orange",label:"Disorder",values:[]};for(let e=5;e<r.length;e++){let t=r[e].split(" ");t.length>4&&l.values.push(parseFloat(t[t.length-1]))}t.qtracks.push(l)},i=function(e,t){const r=(e=e.replace("PSIPRED output:","")).trim().split("\n");let l={color:"#000",label:"Coil",values:[]},n={color:"red",label:"Helix",values:[]},s={color:"blue",label:"Strand",values:[]};for(let e=2;e<r.length;e++){let t=r[e].trim();if(0===t.length)continue;let a=t.replace(/  +/g," ").split(" ");if(a.length<6)continue;let o=a.length>6?1:0;l.values.push(parseFloat(a[3+o])),n.values.push(parseFloat(a[4+o])),s.values.push(parseFloat(a[5+o]))}t.qtracks.push(l),t.qtracks.push(n),t.qtracks.push(s)},c=function(e,t){(e=e.replace("TMHMM output:","")).trim().split("\n").forEach((e=>{if((e=e.trim()).length>0&&!e.startsWith("#")){let r=e.replace(/\t+/g," ").replace(/ +/g," ").split(" ");r.length>4&&"TMhelix"===r[2].trim()&&t.overlayfeatures.features.push({start:parseInt(r[3].trim()),end:parseInt(r[4].trim()),color:"#9acd32",regionType:"TRANSMEMBRANE HELIX",flLabel:"TMhelix"})}}))},u=function(e,t){const r=(e=e.replace("SEG output:","")).trim().split("\n");r[0].startsWith(">")&&(r[0]="");let l,n=r.join("").trim(),s=/x+/g;for(;null!=(l=s.exec(n));)t.overlayfeatures.features.push({start:l.index,end:l.index+l[0].length,color:"#DDD",regionType:"LOW COMPLEXITY",label:"Low complexity"})},p=function(e,t){let r=(e=e.replace("COILS output:","")).trim().split("\n");r[0].startsWith(">")&&(r[0]="");let l,n=r.join(""),s=/x+/g;for(;null!=(l=s.exec(n));)t.overlayfeatures.features.push({start:l.index,end:l.index+l[0].length,color:"#444",regionType:"COILS",label:"Coils"})},f=function(e,t){(e=e.replace("Protein sequence in FASTA format:","")).trim().split("\n").forEach((e=>{const r=e.split(":");r.length>1&&(t.properties[r[0].trim()]=r[1].trim())}))},g=async function(e,t,r){const l=r[0]||!1,n=r[1]||1;let a=/-+/g;const o=e.trim().split("\n");let i=-1,c=0,u=[],p="",f="",g="";for(let e=2;e<o.length;e++){if(c>n){console.log(`read ${c} alignments. exiting read cycle`);break}let r=o[e].trim();if(r.startsWith(">"))c++,f=r.substring(1).split(">")[1]||"",g=f.split(":")[0].trim();else if(i<0){let e,t=r.trim().split(" ");for(t.length>1&&(i=parseInt(t[0].trim()),p=t[1]);null!=(e=a.exec(p.trim()));)u.push({start:e.index,end:e.index+e[0].length})}else if(i>0){const e=g.split(" ")[0].replace("_","");let n=r.trim().split(" "),a={label:e,description:g,gaps:u,start:i,sequence:n[1].trim(),fragmentStart:parseInt(n[0].trim())};l||(a.CS="ALI");const o=(await s(`dssp for ${e} (${c})`,"https://ffas.godziklab.org/ffas/dssp/"+e)).split("\n");o[0]="";let p=o.join("");a.seqcolors={data:d(p,a.start,a.fragmentStart,a.gaps,a.sequence,t.sequence)},t.alignments.push(a),i=-1,u=[]}}},d=function(e,t,r,l,n,s){if(!e||!e.length)return"";n.substring(t-1);let a,o=/-+/g,i=e.substring(r-1),c=[];for(;null!=(a=o.exec(n.trim()));)c.push({start:a.index,end:a.index+a[0].length});let u=i.split("");for(let e=c.length;e>0;e--){let t=c[e-1];for(let e=t.start;e<t.end;e++)u.splice(e,0,".")}for(let e=l.length;e>0;e--){let t=l[e-1];for(let e=t.start;e<t.end;e++)u.splice(e,1,"")}return u.join("")},h={getProtein:async(e,t,r)=>{const l=function(e){return new Promise((function(t,r){r("ConstructDesignerAPI failed: "+e)}))};!e&&l("No dir provided");const o="#696969",i="red",c="blue";let u={label:"",seq:"",seqcolors:{colors:{H:i,E:c,C:o,G:i,I:i,B:c,T:o,S:o," ":"#DDD",X:"orange"},data:""},alignments:[],qtracks:[],ftracks:[],overlayfeatures:{label:"Predictions",features:[]},markers:[],properties:{}};const p="https://xtalpred.godziklab.org/XtalPred-cgi/download.pl?dir="+e+"/",f=await function(e){return console.log("Loading fasta: "+e),n().ajax({type:"GET",cache:!1,url:e,async:!1})}(p+"A.csq");if(!f||!f.length)return null;let d=f.trim().split("\n");d[0].startsWith(">")&&(u.label=d[0].substring(1),d[0]=""),u.sequence=d.join(""),u.label=u.label.replace(/\r/g,""),u.sequence=u.sequence.replace(/\r/g,""),u.sequence=u.sequence.replace(/\n/g,"");const h=async function(e,t,r,n){try{const l=await s(e,t);await r(l,u,n)}catch(t){l(`Failed to load ${e}: ${t}`)}};return await h("Summary",p+"&type=summary",a),await h("psi-blast",p+"pdb101.ali",g,[t,r]),u},parseDSSP:d}}},t={};function r(l){if(t[l])return t[l].exports;var n=t[l]={exports:{}};return e[l](n,n.exports,r),n.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var l in t)r.o(t,l)&&!r.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(175)})();